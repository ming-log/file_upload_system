{% extends "layout.html" %}

{% block title %}课程管理 - 文件上传系统{% endblock %}

{% block content %}
<div class="page-header">
    <h1>课程管理</h1>
    <a href="{{ url_for('create_course') }}" class="btn btn-primary"><i class="fas fa-plus"></i> 添加课程</a>
</div>

<div class="card">
    <div class="card-header">
        <h2>我的课程</h2>
    </div>
    <div class="card-body">
        {% if courses %}
        <div class="table-responsive">
            <table class="table">
                <thead>
                    <tr>
                        <th>课程名称</th>
                        <th>课程代码</th>
                        <th>学期</th>
                        <th>描述</th>
                        <th>关联班级</th>
                        <th>操作</th>
                    </tr>
                </thead>
                <tbody>
                    {% for course in courses %}
                    <tr>
                        <td>{{ course.name }}</td>
                        <td>{{ course.code }}</td>
                        <td>{{ course.semester }}</td>
                        <td class="description-cell" data-description="{{ course.description or '无' }}" style="max-width: 250px; width: 250px;">{{ course.description or '无' }}</td>
                        <td>
                            {% if course.classes %}
                                <div style="max-height: 80px; overflow-y: auto;">
                                    {% for class in course.classes %}
                                        <span class="badge badge-info">{{ class.name }}</span>
                                    {% endfor %}
                                </div>
                            {% else %}
                                <span class="badge badge-danger text-white">无关联班级</span>
                            {% endif %}
                        </td>
                        <td>
                            <div class="btn-group">
                                <a href="{{ url_for('view_course', course_id=course.id) }}" class="btn btn-sm btn-info">
                                    <i class="fas fa-edit"></i> 编辑
                                </a>
                                <button onclick="confirmDelete('course', {{ course.id }}, '{{ course.name }}')" class="btn btn-sm btn-danger">
                                    <i class="fas fa-trash"></i> 删除
                                </button>
                            </div>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        {% else %}
        <div class="alert alert-info">
            您还没有创建任何课程。点击"添加课程"按钮创建您的第一个课程。
        </div>
        {% endif %}
    </div>
</div>

<style>
.badge-danger {
    background-color: #dc3545;
    color: white;
    font-size: 0.9rem;
    font-weight: 600;
    padding: 0.35em 0.8em;
    border-radius: 50rem;
}

.badge-info {
    background-color: #0a58ca;
    color: white;
    font-size: 0.9rem;
    font-weight: 600;
    padding: 0.35em 0.8em;
    border-radius: 50rem;
    margin: 0.2rem;
}
</style>
{% endblock %}

{% block extra_scripts %}
<script>
    function confirmDelete(type, id, name) {
        if (confirm('确定要删除课程 "' + name + '" 吗？此操作不可恢复！')) {
            window.location.href = '/delete_' + type + '/' + id;
        }
    }
</script>
{% endblock %} 